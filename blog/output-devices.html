<!doctype html>
<html style="font-size: 16px;"><head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <meta name="keywords" content="Post 1 Headline">
    <meta name="description" content="">
    <meta name="page_type" content="np-template-header-footer-from-plugin">
    <title>Output Devices</title>
    <link rel="stylesheet" href="../nicepage.css" media="screen">
<link rel="stylesheet" href="../Post-Template.css" media="screen">
    <script class="u-script" type="text/javascript" src="../jquery.js" defer=""></script>
    <script class="u-script" type="text/javascript" src="../nicepage.js" defer=""></script>
    <meta name="generator" content="Nicepage 3.18.0, nicepage.com">
    <link id="u-theme-google-font" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i|Open+Sans:300,300i,400,400i,600,600i,700,700i,800,800i">
    
    
    <script type="application/ld+json">{
		"@context": "http://schema.org",
		"@type": "Organization",
		"name": "Site1",
		"logo": "images/gearfab.png"
}</script>
    <meta name="theme-color" content="#478ac9">
    <meta property="og:title" content="Post Template">
    <meta property="og:description" content="">
    <meta property="og:type" content="website">
  </head>
  <body class="u-body"><header class="u-clearfix u-header u-header" id="sec-ec76"><div class="u-clearfix u-sheet u-sheet-1">
        <a href="../Home.html" data-page-id="14159105" class="u-image u-logo u-image-1" data-image-width="512" data-image-height="510" title="Home">
          <img src="../images/gearfab.png" class="u-logo-image u-logo-image-1" data-image-width="64">
        </a>
        <nav class="u-menu u-menu-dropdown u-offcanvas u-menu-1">
          <div class="menu-collapse" style="font-size: 1rem; letter-spacing: 0px;">
            <a class="u-button-style u-custom-left-right-menu-spacing u-custom-padding-bottom u-custom-top-bottom-menu-spacing u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="#">
              <svg><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#menu-hamburger"></use></svg>
              <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><symbol id="menu-hamburger" viewBox="0 0 16 16" style="width: 16px; height: 16px;"><rect y="1" width="16" height="2"></rect><rect y="7" width="16" height="2"></rect><rect y="13" width="16" height="2"></rect>
</symbol>
</defs></svg>
            </a>
          </div>
          <div class="u-custom-menu u-nav-container">
            <ul class="u-nav u-unstyled u-nav-1"><li class="u-nav-item"><a class="u-button-style u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="../Home.html" style="padding: 10px 20px;">Main</a><div class="u-nav-popup"><ul class="u-h-spacing-20 u-nav u-unstyled u-v-spacing-10 u-nav-2"><li class="u-nav-item"><a class="u-button-style u-nav-link u-white" href="../About.html">About Me</a>
</li></ul>
</div>
</li></ul>
          </div>
          <div class="u-custom-menu u-nav-container-collapse">
            <div class="u-black u-container-style u-inner-container-layout u-opacity u-opacity-95 u-sidenav">
              <div class="u-sidenav-overflow">
                <div class="u-menu-close"></div>
                <ul class="u-align-center u-nav u-popupmenu-items u-unstyled u-nav-3"><li class="u-nav-item"><a class="u-button-style u-nav-link" href="../Home.html" style="padding: 10px 20px;">Main</a><div class="u-nav-popup"><ul class="u-h-spacing-20 u-nav u-unstyled u-v-spacing-10 u-nav-4"><li class="u-nav-item"><a class="u-button-style u-nav-link" href="../About.html">About Me</a>
</li></ul>
</div>
</li></ul>
              </div>
            </div>
            <div class="u-black u-menu-overlay u-opacity u-opacity-70"></div>
          </div>
        </nav>
      </div></header>
    <section class="u-align-center u-clearfix u-section-1" id="sec-b45a">
      <div class="u-clearfix u-sheet u-valign-middle-md u-valign-middle-sm u-valign-middle-xs u-sheet-1"><!--post_details--><!--post_details_options_json--><!--{"source":""}--><!--/post_details_options_json--><!--blog_post-->
        <div class="u-container-style u-expanded-width u-post-details u-post-details-1">
          <div class="u-container-layout u-valign-middle u-container-layout-1"><!--blog_post_image-->
            <img alt="" class="u-blog-control u-expanded-width u-image u-image-default u-image-1" src="../images/2ae81ad1aa271d0c2d2589dc23ff11fda49d7f06fa554023ca61537353996c5f1973dc4a51d0866335897ba334f031d26510784133b4a84523fab6_1280.jpg"><!--/blog_post_image--><!--blog_post_header-->
            <h2 class="u-blog-control u-text u-text-1">Output Devices</h2><!--/blog_post_header--><!--blog_post_metadata-->
            <div class="u-blog-control u-metadata u-metadata-1"><!--blog_post_metadata_date-->
              <span class="u-meta-date u-meta-icon">Jul 20, 2021</span><!--/blog_post_metadata_date--><!--blog_post_metadata_category-->
              <!--/blog_post_metadata_category--><!--blog_post_metadata_comments-->
              <!--/blog_post_metadata_comments-->
            </div><!--/blog_post_metadata--><!--blog_post_content-->
            <div class="u-align-justify u-blog-control u-post-content u-text u-text-2 fr-view"><p>T<img src="../images/hqdefault.jpg" width="229" style="width: 185px;" class="fr-dii fr-fic fr-fil">his week we explore interrupts, which allows us to bypass main loop code when a physical stimulus or timer is activated, enabling much more efficient and reliable code when executed properly. I spent some time working with interrupts in high school when building an electric vehicle, namely for recording how far the vehicle has travelled using rotary encoders. Interrupts are imperative for quadrature encoders which follow a specific pattern of signals which tell us when we have travelled each tick. A brief rundown of how the encoders work is shown on the left.</p><p>For this week, I decided to explore the LED strip since I haven't worked with it before. After doing some r<img src="../images/Screenshot193.png" width="429" style="width: 363px;" class="fr-dii fr-fic fr-fir">esearch I found that a great library for our 3-pin pwm LED strip is fastLED. After installing the library, I tested out the code on one light and later expanded it to light up all 10 LEDs on the strip with different colors. After successfully lighting up the LEDs to different colors, I initiated the LED values to create a rainbow gradient by changing the "hue" value for each - the code for this is shown on the right. I then made the LED strip animated by shifting the values of each light to create a moving rainbow effect, which we can see on the gif below.</p><p><img src="../images/no_button.gif" width="320" style="width: 342px;" class="fr-dib fr-fic"></p><p>Aft<img src="../images/Screenshot189.png" width="569" style="width: 431px;" class="fr-dii fr-fic fr-fil">er successfully lighting up the LED strip and getting it to show a rainbow, I decided to attach a button for input. For simplicty, I started without using an interrupt and simply using delays to make the button shift the rainbow whenever it is pressed. The resulting button-triggered animation is shown below, with the rainbow shifting when the button is pressed. The code for the button-triggered rainbow LED strip animation is straight forward, shown on the right.</p><p><img src="../images/button.gif" width="320" style="width: 370px;" class="fr-dib fr-fic"></p><p>Final<img src="../images/Screenshot195.png" width="589" style="width: 535px;" class="fr-dii fr-fic fr-fil">ly, I set out to integrate interrupts into the project. I decided to design the device to shift the rainbow by one led every time the button is either pressed or released, and put the previous code into an interrupt change function, as seen in the code on the right. As a result we got a successfully shifting LED strip triggered by interrupts. Unfortunately, I quickly began running into issues. Namely, after rapidly pressing the button for 10 or so seconds, the rainbow on the strip would stop moving, and the arduino would basically freeze until it was forcibly restarted. The interrupt shifting strip is shown below, as well as how it freezes after working for a number of cycles.</p><p><img src="../images/interrupt.gif" width="320" style="width: 410px;" class="fr-dib fr-fic"></p><p>After trying a number of options without succeeding to shift it more than 10-15 places before the freeze, I figured out that it was due to the PWM interraction, which I have had a lot of experience with through quadrature encoders. When I built my electric vehicle, I would control a brushless motor with an ESC (electronic speed controller) which took in a PWM signal. The vehicle was coded to speed up, go for some distance, then slow down and come to a stop. However, sometimes the vehicle would just speed up indefinitely and never slow down. After much pain and many broken cars I figured out it was due to the interrupts on the encoder being triggered as the microcontroller is sending PWM signals to the ESC, causing the signal to be distorted and potentially have the quadrature interrupts even come into resonance with the PWM signal, scewing the signal the ESC receives.</p><p>Here we could have a similar effect, since the microcontroller uses PWM to send signals to the LED strip. Perhaps an interrupt from the button press is activated during a signaling event built into the fastLED library, and it creates some unexpeted interaction which leads to a freeze or a while true loop of some sort.</p></div><!--/blog_post_content-->
          </div>
        </div><!--/blog_post--><!--/post_details-->
      </div>
    </section>
    
    
    <footer class="u-align-center u-clearfix u-footer u-grey-80 u-footer" id="sec-3dea"><div class="u-align-left u-clearfix u-sheet u-sheet-1"></div></footer>
  
</body></html>